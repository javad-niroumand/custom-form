<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>R√ºckruf Informationen</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<style>
:root{
  --purple:#8b5cf6;
}
body{
  margin:0;
  font-family:'Segoe UI',sans-serif;
  background:#f4f4f4;
  display:flex;
  flex-direction:column;
  align-items:center;
  color:#222;
}
header{
  width:100%;
  background:#fff;
  text-align:center;
  padding:15px 0;
}
header img{height:40px;}
header h1{
  margin:5px 0;
  font-size:22px;
  font-weight:700;
  color:var(--purple);
  letter-spacing:0.5px;
}

/* Banner */
.top-banner{
  background:var(--purple);
  padding:12px;
  display:flex;
  flex-direction:column;
  border-radius:12px;
  color:#fff;
  width:100%;
  max-width:420px;
  box-sizing:border-box;
  margin:10px auto;
}
.banner-header{
  display:flex;
  justify-content:space-between;
  font-weight:600;
  font-size:14px;
}
.banner-header span{cursor:pointer;}
.dates{
  display:flex;
  justify-content:space-around;
  gap:4px;
  margin-top:8px;
}
.date-item{
  flex:1;
  background:rgba(255,255,255,0.1);
  border:1px solid rgba(255,255,255,0.3);
  border-radius:8px;
  text-align:center;
  padding:4px 0;
  font-size:11px;
  cursor:pointer;
}
.date-item .dom{display:block;font-size:13px;font-weight:700;}
.date-item.active{background:#fff;color:var(--purple);}

/* Time */
.time-container{
  width:100%;
  max-width:420px;
  text-align:center;
  margin:10px auto;
  padding:0 8px;
  box-sizing:border-box;
}
.time-container label{
  display:block;
  font-weight:600;
  margin-bottom:4px;
}
.time-container input{
  width:100%;
  padding:10px;
  border-radius:8px;
  border:1px solid #ccc;
  font-size:16px;
  text-align:center;
}

/* Appointment boxes */
.appointments{
  width:100%;
  max-width:420px;
  margin:5px auto;
  padding:0 8px;
  box-sizing:border-box;
}
.appointment-box{
  background:#fff;
  padding:12px;
  border-radius:10px;
  box-shadow:0 2px 6px rgba(0,0,0,0.1);
  margin-bottom:8px;
}
.appointment-box h3{
  margin:0 0 3px;
  font-size:14px;
  color:var(--purple);
}
.appointment-box p{margin:0;font-size:13px;}

/* Buttons */
.buttons{
  width:100%;
  max-width:420px;
  margin:10px auto;
  padding:0 8px;
  box-sizing:border-box;
  text-align:center;
}
.save-btn{
  width:100%;
  background:var(--purple);
  color:#fff;
  font-weight:bold;
  padding:12px;
  border:none;
  border-radius:8px;
  cursor:pointer;
  font-size:16px;
}

/* Services */
.services{
  background:#fff;
  width:100%;
  max-width:420px;
  margin:12px auto;
  border-radius:10px;
  box-shadow:0 2px 6px rgba(0,0,0,0.1);
  padding:14px;
  text-align:center;
  box-sizing:border-box;
}
.services p{
  font-size:15px;
  font-weight:600;
  color:#333;
  margin-bottom:10px;
  line-height:1.4;
}
.icons{
  display:flex;
  justify-content:space-around;
  margin-top:8px;
}
.icon-circle{
  background:var(--purple);
  color:#fff;
  width:45px;
  height:45px;
  border-radius:50%;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:18px;
}

/* Banner image */
.banner-img{
  width:100%;
  max-width:420px;
  border-radius:12px;
  overflow:hidden;
  margin:12px auto;
  box-sizing:border-box;
}
.banner-img img{
  width:100%;
  display:block;
}
</style>
</head>
<body>

<header>
  <img src="https://intranet.gruendungswerft.com/wp-content/uploads/2024/05/1komma5.png">
  <h1>R√ºckruf&nbsp;Informationen</h1>
</header>

<div class="top-banner">
  <div class="banner-header">
    <span id="prevMonth">‚Äπ</span>
    <div id="monthLabel">September</div>
    <span id="nextMonth">‚Ä∫</span>
  </div>
  <div class="dates" id="datesRow"></div>
</div>

<div class="time-container">
  <label for="timeInput">Gew√ºnschte R√ºckrufzeit</label>
  <input type="time" id="timeInput" value="21:00">
</div>

<div class="appointments">
  <div class="appointment-box">
    <h3>Kundename</h3>
    <p id="userName"></p>
  </div>
  <div class="appointment-box">
    <h3>Telefonnummer</h3>
    <p id="userPhone"></p>
  </div>
</div>

<div class="buttons">
  <button class="save-btn" id="saveBtn">R√ºckruf anpassen</button>
</div>

<div class="services">
  <p>Unser Kundenservice ist<br><strong>rund um die Uhr (24h) f√ºr Sie erreichbar</strong>.</p>
  <div class="icons">
    <div class="icon-circle"><i class="fa fa-envelope"></i></div>
    <div class="icon-circle"><i class="fa fa-phone"></i></div>
    <div class="icon-circle"><i class="fa-brands fa-whatsapp"></i></div>
  </div>
</div>

<div class="banner-img">
  <img src="https://github.com/javad-niroumand/Lisa/blob/main/Screenshot%202025-09-17%20231416.jpg?raw=true" alt="Banner">
</div>

<script>
const apiUrl = "https://6797e9d9c2c861de0c6e6bdf.mockapi.io/costumerData/1";

/* month/dates rendering */
const monthLabel=document.getElementById('monthLabel');
const datesRow=document.getElementById('datesRow');
let monthIndex=new Date().getMonth();
let year=new Date().getFullYear();
function renderDates(){
  const monthNames=['Januar','Februar','M√§rz','April','Mai','Juni','Juli','August','September','Oktober','November','Dezember'];
  monthLabel.textContent=monthNames[monthIndex];
  datesRow.innerHTML='';
  for(let i=0;i<5;i++){
    const d=new Date(year,monthIndex,new Date().getDate()+i);
    const div=document.createElement('div');
    div.className='date-item';
    div.innerHTML=`${d.toLocaleDateString('de-DE',{weekday:'short'})}<span class="dom">${d.getDate()}</span>`;
    div.onclick=()=>{document.querySelectorAll('.date-item').forEach(x=>x.classList.remove('active'));div.classList.add('active');};
    datesRow.appendChild(div);
  }
}
document.getElementById('prevMonth').onclick=()=>{monthIndex=(monthIndex-1+12)%12;renderDates();};
document.getElementById('nextMonth').onclick=()=>{monthIndex=(monthIndex+1)%12;renderDates();};
renderDates();

/* API prefill */
window.addEventListener('DOMContentLoaded', async () => {
  try {
    const res = await fetch(apiUrl);
    if (!res.ok) return;
    const user = await res.json();
    document.getElementById('userName').textContent = user.Username || '';
    document.getElementById('userPhone').textContent = user.PhoneNumber || '';

    // remove existing active before marking API date
    document.querySelectorAll('.date-item').forEach(el=>el.classList.remove('active'));

    if (user.CallDate) {
      const parts = user.CallDate.split('/');
      if (parts.length === 3) {
        const day = parts[0];
        [...datesRow.children].forEach(el=>{
          if(el.querySelector('.dom').textContent==day){
            el.classList.add('active');
          }
        });
      }
    }
    document.getElementById('timeInput').value = user.CallTime || '09:00';
  } catch (err) {
    console.error("Prefill error:", err);
  }
});

/* Save */
document.getElementById('saveBtn').addEventListener('click', async () => {
  const selectedDateItem=document.querySelector('.date-item.active .dom');
  let day=selectedDateItem?selectedDateItem.textContent:new Date().getDate();
  let formattedDate=`${day}/${(monthIndex+1).toString().padStart(2,'0')}/${year}`;
  const data={
    PhoneNumber:document.getElementById('userPhone').textContent,
    CallDate:formattedDate,
    CallTime:document.getElementById('timeInput').value
  };
  try{
    const res=await fetch(apiUrl,{
      method:'PUT',
      headers:{'Content-Type':'application/json'},
      body:JSON.stringify(data)
    });
    if(res.ok){
      alert("‚úîÔ∏è R√ºckruf erfolgreich angepasst.");
    } else {
      alert("‚ùå √Ñnderungen konnten nicht gespeichert werden.");
    }
  }catch(err){
    alert("üö® Fehler: "+err.message);
  }
});
</script>

</body>
</html>
